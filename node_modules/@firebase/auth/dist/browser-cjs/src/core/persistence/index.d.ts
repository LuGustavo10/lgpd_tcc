ers:e})];case 1:return[2,n.sent()]}})})})];case 1:return[2,l.sent()]}})})},r.prototype.getFeedItemPreviewAsync=function(t,i,r){return __awaiter(this,void 0,void 0,function(){var u,f,e,o=this;return __generator(this,function(s){switch(s.label){case 0:return u=n.getDsbUrl("api/v1/dsb/feed/preview"),f="previewType=".concat(t,"&previewUrl=").concat(encodeURIComponent(i),"&previewProxyUrl=").concat(encodeURIComponent(r),"&size=Medium"),e="".concat(u,"?").concat(f),[4,this.promisifyRefreshTokenAndCall().then(function(){return __awaiter(o,void 0,void 0,function(){return __generator(this,function(n){switch(n.label){case 0:return[4,this.msbHttpWrapper.sendHttpAsync({url:e,method:"GET"})];case 1:return[2,n.sent()]}})})})];case 1:return[2,s.sent()]}})})},r.prototype.getFileIconAsync=function(i){return __awaiter(this,void 0,void 0,function(){var r;return __generator(this,function(){return r=n.getIconForTypeAsync(t.DEFAULT_FILE_ICON,"."+i,0),[2,new Promise(function(n){r(4,function(t){n(t)})})]})})},r.prototype.promisifyRefreshTokenAndCall=function(){var t=this;return new Promise(function(i,r){t.msbTokenManager.refreshMsbTokenAndCall(function(n){return i(n)},function(){var t={statusCode:n.ClientErrorCode.NoWsbAccessToken,errorMessage:"Wsb Dsb No Msb Token"};return r(t)},(n.Host===null||n.Host===void 0?void 0:n.Host.isAuthInvestigation())?["MsbServiceClient::promisifyRefreshTokenAndCall"]:undefined)})},r.prototype.buildFeedUrl=function(){function r(n,t,i){t&&n.push(i)}var f=n.getDsbUrl("api/v1/dsb/feed"),i="",t,u;return(i=(n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?void 0:n.TestHookUrlPa